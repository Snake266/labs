\maketitle
\tableofcontents
\newpage

\section{Девятое задание}
\paragraph{Текст задания} ~\\
Даны формула численного дифференцирования и таблично заданная функция $y(x)$ (данные в таблице могут содержать погрешность не более $\delta$). Определить оптимальное значение шага $h_{\text{опт}}$, когда достигается максимально возможная точность данной формулы, а неустойчивость численного дифференцирования еще себя не проявляет.\\[2mm]
\[
  \text{ф-ла } y_{0}^{''} = \frac{1}{h^{2}} (y_{0} - 2y_{1} + y_{2}); \text{функ. } y(x) = cos x \text{ на отрезке } \left[ \frac{\pi}{4}, 4 \right]; \text{ погр. } \delta = 10^{-8}
\]

\paragraph{Решение} ~\\
Из-за округления чисел в мантиссе любые вычисления на компьютере ограничены машинной точностью $\delta$.
В действительности компьютер вычислит:
\begin{align*}
  y_{0}^{''} & = \frac{1}{h^2} (\widetilde{y_{0}} - 2 \widetilde{y_{1}} + \widetilde{y_{2}})\\
  & \text{, где } \widetilde y_{0} = y_{0} + \delta_{0}; \widetilde y_{1} = y_{1} + \delta_{1}; \widetilde y_{2} = y_{2} + \delta_{2}
\end{align*}
Рассмотрим погрешность:
\begin{equation*}
  \begin{split}
    \Delta & = \left| y_{0}^{''} - \frac{y_{0} + \delta_{0} - 2 y_{1} - 2\delta_{1} + y_{2} + \delta_{2}}{h^{2}} \right| = \\[2mm]
    & = \left| \left( y_{0}^{''} - \frac{y_{0} - 2y_{1} + y_{2}}{h^{2}} \right) + \left( \frac{\delta_{0}}{h^{2}} - \frac{2\delta_{1}}{h^{2}} + \frac{\delta_{2}}{h^{2}} \right)\right| \leq \\[2mm]
    & \leq \left| \left( y_{0}^{''} - \frac{y_{0} - 2y_{1} + y_{2}}{h^{2}}  \right) + \left|\frac{\delta_{0}}{h^{2}}\right| + \left|\frac{2\delta_{1}}{h^{2}}\right| + \left|\frac{\delta_{2}}{h^{2}}\right|  \right| \leq \\[2mm]
    & \leq \left| \left( y_{0}^{''} - \frac{y_{0} - 2y_{1} + y_{2}}{h^{2}}  \right)  \right| + \left| \frac{4\delta}{h^{2}} \right|
  \end{split}
\end{equation*}
Для оценки разности
\begin{equation}
  \left| \left(y_{0}^{''} - \frac{y_{0} - 2y_{1} + y_{2}}{h^{2}} \right) \right| \label{first_task_subs}
\end{equation}
разложим $y_{1}$ и $y_{2}$ в ряд Тейлорав окрестности $x_{0}$ до $h^{3}$
\begin{gather}
  y_{1} = y_{0} + h y_{0}^{'} + \frac{h^{2}y_{0}^{''}}{2} + \frac{h^{3}y^{'''}(\xi_{1})}{6} \label{first_task_subs_y_1}\\
    y_{2} = y_{0} + 2hy_{0}^{'} + \frac{h^{2}y_{0}^{''}}{2} + \frac{8h^{3}y^{'''}(\xi_{2})}{6} \label{first_task_subs_y_2}
\end{gather}
Подставим ~\eqref{first_task_subs_y_1} и ~\eqref{first_task_subs_y_2} в ~\eqref{first_task_subs}
\begin{equation*}
  \begin{split}
    & \left| y_{0}^{''} - \frac{y_{0} - 2y_{0} - 2hy_{0}^{'} - h^{2}y_{0}^{''}-\frac{h^{3}y^{'''}(\xi_{1})}{3} + y_{0} + 2hy_{0}^{'} + 2h^{2}y_{0}^{''} + \frac{h^{3}y^{'''}(\xi_{2})}{3}}{h^{2}} \right| =\\
    = &\left| y_{0}^{''} - \frac{h^{2}y_{0}^{''} + h^{3}y^{'''}(\xi)}{h^{2}} \right| =\\
    = & \left|y_{0}^{''} - y_{0}^{''} + hy^{'''}(\xi) \right| =\\
    = & \left| hy^{'''}(\xi) \right|
  \end{split}
\end{equation*}
Таким образом, $\Delta \leq \left| hy^{'''}(\xi) \right| + \left|\frac{4\delta}{h^{2}}\right| \leq hM_{3} + \frac{4\delta}{h^{2}} = \Phi(h)$
Минимизируем ошибку $\Phi(h)$:
\[
    h_{\text{опт}} \Phi^{'}(h) = M_{3} - \frac{8\delta}{h^{3}} = 0 \Rightarrow h_{\text{опт}} = \sqrt[3]{\frac{8\delta}{M_{3}}}
\]

Найдем $M_{3} = \max_{\left[\frac{\pi}{4}; \pi\right]}|y^{'''}(x)|$. Так как $y^{'''}(x) = \sin(x) \Rightarrow M_{3} = 1$
\[
  h_{\text{опт}} = \sqrt[3]{\frac{8 \cdot 10^{-8}}{1}} 2 \cdot 10^{-\frac{8}{3}} \approx 2 \cdot 10^{-2.7}
\]

\section{Десятое задание}
\paragraph{Текст задания} ~\\
Получить (письменно) приближённое значение интеграла $I$ по по квадратурной формуле $S(h)$ сначала с шагом $h_{1}$, а затем с шагом $h_{2}$. Используя метод Рунге, указать насколько значение $S(h_{2})$ отличается от истинногозначения интеграла $I$.\\[2mm]

\[
  I = \int_{1}^{3} \sin x \sh x dx; S(h) = h \sum_{i=1}^{n} f(x_{i-1}) (\text{ф-ла левых прямоуг.}); h_{1} = \frac{2}{4}, h_{2} = \frac{2}{12}
\]

\paragraph{Решение} ~\\
Для $h_{1}= \frac{2}{4}$:
\begin{lstlisting}
  f = @(x) sin(x).*sinh(x);
  disp('x_i:')
  h = 2/4;
  a = 1; b = 3;
  x = a : h : b
  S = h * sum(f(x))
\end{lstlisting}
\begin{lstlisting}[backgroundcolor=\color{cyan}]
  x_i:
  x =

  1.0000    1.5000    2.0000    2.5000    3.0000

  S = 5.7227
\end{lstlisting}
Для $h_{2} = \frac{2}{12}$:
\begin{lstlisting}
  f = @(x) sin(x).*sinh(x);
  disp('x_i:')
  h = 2/12;
  a = 1; b = 3;
  x = a : h : b
  S = h * sum(f(x))
\end{lstlisting}
\begin{lstlisting}[backgroundcolor=\color{cyan}]
  x_i:
  x =
  1.0000    1.1667    1.3333    1.5000    1.6667    1.8333    2.0000    2.1667    2.3333    2.5000    2.6667    2.8333    3.0000

  S = 5.5135
\end{lstlisting}

Найдем погрешность:
\begin{gather*}
  I \approx S\left(\frac{2}{4}\right) + c \cdot \left(\frac{2}{4}\right)^{2} \approx S\left(\frac{2}{12}\right) + c \cdot \left(\frac{2}{12}\right)^{2}\\[2mm]
  S\left(\frac{2}{4}\right) + \frac{c}{4} \approx S\left(\frac{2}{12}\right) + \frac{c}{36}\\[2mm]
  \frac{c}{4} - \frac{c}{36} = S\left(\frac{2}{12}\right) - S\left(\frac{2}{4}\right)\\[2mm]
  \frac{2c}{9} = S\left(\frac{2}{12}\right) - S\left(\frac{2}{4}\right)\\[2mm]
  c = \frac{9 \left(S\left(\frac{2}{12}\right) - S\left(\frac{2}{4}\right)\right)}{2}
\end{gather*}

\begin{align*}
  \epsilon = I - S\left(\frac{2}{12}\right) = c \cdot h_{2}^{2} = \left| \frac{9 \left(S\left(\frac{2}{12}\right) - S\left(\frac{2}{4}\right)\right)}{2 \cdot 36} \right| = \left| \frac{\left(S\left(\frac{2}{12}\right) - S\left(\frac{2}{4}\right)\right)}{8} \right| = \left|\frac{5.5135 - 5.7227}{8} \right| \approx 0.026
\end{align*}
